<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Solaria ‚Äî Ordering System</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --gold: #d4af37;
      --gold-strong: #c79e2d;
      --bg: #0b0b0b;
      --card: #111214;
      --muted: #bfbfbf;
      --accent-border: rgba(212,175,55,0.18);
    }

    body {
      margin: 0;
      font-family: Inter, system-ui, sans-serif;
      background: var(--bg);
      color: #fff;
    }

    .container { max-width: 1100px; margin: 0 auto; padding: 18px; }

    h1 {
      color: var(--gold);
      font-weight: bold;
      text-align: center;
      margin-bottom: 16px;
    }

    /* MENU DESIGN */
    .menu-section {
      background: rgba(255,255,255,0.02);
      border: 1px solid var(--accent-border);
      border-radius: 12px;
      padding: 14px;
      margin-bottom: 10px;
    }

    .menu-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: linear-gradient(90deg, rgba(212,175,55,0.06), transparent);
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      color: var(--gold);
    }

    .menu-subgroup { margin-top: 10px; }
    .items-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
    @media(min-width:768px){ .items-grid { grid-template-columns: repeat(3, 1fr); } }

    .menu-item {
      background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.005));
      border: 1px solid rgba(212,175,55,0.08);
      border-radius: 10px;
      padding: 10px;
      text-align: center;
    }
    .menu-item h4 { color: #fff; font-weight: 600; font-size: 0.95rem; }

    select, input[type="number"] {
      width: 100%;
      padding: 6px;
      border-radius: 6px;
      border: 1px solid #333;
      background: #141414;
      color: white;
      text-align: center;
    }

    .btn-add {
      background: var(--gold);
      color: #0b0b0b;
      font-weight: bold;
      border-radius: 6px;
      padding: 6px;
      margin-top: 6px;
      width: 100%;
    }
    .btn-add:hover { background: var(--gold-strong); }

    /* FIXED ORDER BAR */
    #order-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(10,10,10,0.97);
      border-top: 1px solid rgba(212,175,55,0.2);
      padding: 10px 14px;
      display: flex;
      flex-direction: column;
      gap: 6px;
      z-index: 50;
      box-shadow: 0 -2px 20px rgba(0,0,0,0.7);
      max-height: 45vh;
    }

    #order-list {
      overflow-y: auto;
      max-height: 22vh;
      padding-right: 6px;
    }

    .order-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 8px;
      background: #111;
      border-radius: 6px;
      font-size: 0.9rem;
      margin-bottom: 4px;
    }

    .order-item input {
      width: 55px;
      background: #1a1a1a;
      border: 1px solid #333;
      color: white;
      text-align: center;
      border-radius: 4px;
      padding: 3px;
    }

    .btn-remove {
      background: #b9322b;
      color: white;
      border-radius: 4px;
      padding: 4px 8px;
    }

    .bottom-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-top: 1px solid rgba(212,175,55,0.15);
      padding-top: 6px;
    }

    .total {
      color: var(--gold);
      font-size: 1.1rem;
      font-weight: bold;
    }

    .btn-clear, .btn-checkout {
      border-radius: 6px;
      padding: 6px 10px;
      font-weight: 600;
    }

    .btn-clear { background: #b9322b; color: white; }
    .btn-checkout { background: var(--gold); color: black; }
    .btn-clear:hover { background: #e14d4d; }
    .btn-checkout:hover { background: var(--gold-strong); }

    main { padding-bottom: 48vh; } /* Prevents overlap with fixed order bar */
  </style>
</head>
<body>
  <div class="container">
    <h1>‚òï Solaria ‚Äî Ordering System</h1>
    <main id="menu-container"></main>
  </div>

  <!-- FIXED ORDER BAR -->
  <div id="order-bar">
    <div id="order-list"></div>
    <div class="bottom-controls">
      <div class="total">Total: ‚Ç±<span id="total">0.00</span></div>
      <div class="flex gap-2">
        <button id="clear" class="btn-clear">Clear</button>
        <button id="checkout" class="btn-checkout">Checkout</button>
      </div>
    </div>
  </div>

  <script>
    const menus = [
       {
        name: "üçπ Beverages Menu",
        subgroups: {
          "Espresso Based (Iced)": [
            { id: "spanish_12", name: "Spanish Latte (Iced)", prices: { "12oz": 69, "16oz": 79 } },
            { id: "caramel_iced_12", name: "Caramel Macchiato (Iced)", prices: { "12oz": 79, "16oz": 89 } },
            { id: "mocha_iced", name: "Mocha (Iced)", prices: { "12oz": 79, "16oz": 89 } },
            { id: "affogato_iced", name: "Affogato Latte (Iced)", prices: { "12oz": 89, "16oz": 99 } },
          ],
          "Espresso Based (Hot)": [
            { id: "hot_americano", name: "Hot Americano", prices: { "8oz": 59 } },
            { id: "hot_spanish", name: "Hot Spanish Latte", prices: { "8oz": 79 } },
          ],
          "Non-Coffee": [
            { id: "milkyberry", name: "Milky Berry", prices: { "12oz": 59, "16oz": 69 } },
            { id: "classic_matcha", name: "Classic Matcha (unsweetened)", prices: { "12oz": 79, "16oz": 89 } },
            { id: "creamy_matcha", name: "Creamy Matcha Latte", prices: { "12oz": 89, "16oz": 99 } },
          ],
          "Frappe Series": [
            { id: "strawberry_bliss", name: "Strawberry Bliss (Frappe)", prices: { "16oz": 109 } },
            { id: "frappe_caramel", name: "Caramel Macchiato (Frappe)", prices: { "16oz": 119 } },
            { id: "java_chips", name: "Java Chips (Frappe)", prices: { "16oz": 119 } },
            { id: "choco_hazelnut", name: "Choco Hazelnut (Frappe)", prices: { "16oz": 129 } },
            { id: "kitkat_frappe", name: "KitKat (Frappe)", prices: { "16oz": 139 } },
            { id: "biscoff_frappe", name: "Biscoff (Frappe)", prices: { "16oz": 149 } },
          ],
        },
      },

      // SOLARIA'S MENU
      {
        name: "üçõ Solaria‚Äôs Menu",
        subgroups: {
          "Silog Meals": [
            { id: "longsilog", name: "Longsilog", prices: { regular: 89 } },
            { id: "cheesybacsilog", name: "Cheesy Bacsilog", prices: { regular: 99 } },
            { id: "porksilog", name: "Porksilog", prices: { regular: 99 } },
            { id: "tapsilog", name: "Tapsilog", prices: { regular: 109 } },
          ],
          "Chicken": [
            { id: "2pc_wings", name: "2pcs Wings w/ Rice", prices: { regular: 89 } },
            { id: "4pc_wings", name: "4pcs Wings w/ Rice", prices: { regular: 129 } },
            { id: "6pc_wings", name: "6pcs Wings (A la carte)", prices: { regular: 149 } },
          ],
          "Pasta": [
            { id: "spicy_tuna", name: "Spicy Tuna Pasta", prices: { regular: 89 } },
            { id: "creamy_spaghetti", name: "Creamy Spaghetti", prices: { regular: 99 } },
          ],
          "Beef / Burger / Patty": [
            { id: "burger_egg", name: "Burger Steak w/ Egg", prices: { regular: 99 } },
            { id: "double_patty", name: "Double Patty Burger Steak", prices: { regular: 129 } },
            { id: "double_patty_egg", name: "Double Patty Burger Steak w/ Egg", prices: { regular: 139 } },
          ],
        },
      },
    ];

    const container = document.getElementById("menu-container");
    const orderListEl = document.getElementById("order-list");
    const totalEl = document.getElementById("total");
    let order = {};

    // Build Menu
    menus.forEach((menu, i) => {
      const section = document.createElement("section");
      section.className = "menu-section";
      const header = document.createElement("div");
      header.className = "menu-header";
      header.innerHTML = `${menu.name}<span id="icon-${i}">‚ñº</span>`;
      section.appendChild(header);

      const content = document.createElement("div");
      content.style.display = "none";
      content.style.marginTop = "10px";

      Object.entries(menu.subgroups).forEach(([sub, items]) => {
        const subDiv = document.createElement("div");
        subDiv.className = "menu-subgroup";
        subDiv.innerHTML = `<h3 style="color:var(--gold);margin-bottom:4px;">${sub}</h3>`;
        const grid = document.createElement("div");
        grid.className = "items-grid";

        items.forEach(item => {
          const card = document.createElement("div");
          card.className = "menu-item";
          const options = Object.entries(item.prices)
            .map(([size, price]) => `<option value="${price}">${size} - ‚Ç±${price}</option>`)
            .join("");
          card.innerHTML = `
            <h4>${item.name}</h4>
            <select id="size-${item.id}">${options}</select>
            <input id="qty-${item.id}" type="number" min="1" value="1">
            <button class="btn-add" onclick="addToOrder('${item.id}','${item.name}')">Add</button>
          `;
          grid.appendChild(card);
        });

        subDiv.appendChild(grid);
        content.appendChild(subDiv);
      });

      header.addEventListener("click", () => {
        const visible = content.style.display === "block";
        content.style.display = visible ? "none" : "block";
        document.getElementById(`icon-${i}`).textContent = visible ? "‚ñº" : "‚ñ≤";
      });

      section.appendChild(content);
      container.appendChild(section);
    });

    // Add to order
    window.addToOrder = function(id, name) {
      const sizeSel = document.getElementById(`size-${id}`);
      const price = parseFloat(sizeSel.value);
      const size = sizeSel.options[sizeSel.selectedIndex].text.split(" - ")[0];
      const qty = parseInt(document.getElementById(`qty-${id}`).value) || 1;
      const key = `${id}_${size}`;
      if (!order[key]) order[key] = { name: `${name} (${size})`, price, qty };
      else order[key].qty += qty;
      renderOrder();
    };

    function renderOrder() {
      orderListEl.innerHTML = "";
      let total = 0;
      for (const key in order) {
        const item = order[key];
        total += item.price * item.qty;
        const div = document.createElement("div");
        div.className = "order-item";
        div.innerHTML = `
          <div>
            <div>${item.name}</div>
            <div style="font-size:0.8rem;color:#aaa;">‚Ç±${item.price}</div>
          </div>
          <div class="flex items-center gap-2">
            <input type="number" min="1" value="${item.qty}" onchange="updateQty('${key}', this.value)">
            <button class="btn-remove" onclick="removeItem('${key}')">‚úï</button>
          </div>
        `;
        orderListEl.appendChild(div);
      }
      totalEl.textContent = total.toFixed(2);
    }

    window.updateQty = (key, val) => {
      const qty = parseInt(val);
      if (qty <= 0) delete order[key];
      else order[key].qty = qty;
      renderOrder();
    };

    window.removeItem = (key) => {
      delete order[key];
      renderOrder();
    };

    document.getElementById("clear").onclick = () => { order = {}; renderOrder(); };
   document.getElementById("checkout").onclick = async () => {
  if (Object.keys(order).length === 0) {
    alert("No items to checkout!");
    return;
  }

  const items = Object.values(order).map(it => ({
    name: it.name,
    size: it.name.match(/\((.*?)\)/)?.[1] || "N/A",
    qty: it.qty,
    price: it.price
  }));

  const payload = { items };

  try {
    const response = await fetch("https://script.google.com/macros/s/AKfycbxV0IuZRcyAzVtVQa8qjTkk0X3WxI34o9h4lu-SQu2Vkx95VPkrvqo42DdEOiVxW6wC/exec", {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    alert("‚úÖ Order saved to Google Sheet!");
    order = {};
    renderOrder();
  } catch (err) {
    alert("‚ùå Failed to save order. Check your Apps Script deployment.");
    console.error(err);
  }
};

  </script>
</body>
</html>
